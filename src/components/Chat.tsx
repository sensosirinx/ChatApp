import React, { useEffect } from 'react'
import { useTypedSelector } from '../hooks/useTypedSelector'
import { useActions } from '../hooks/useActions'
import ChatWindow from './ChatWindow'
import { ChatsIconsProps } from '../types/chat'


const Chat: React.FC = () => {

  const { typeChat } = useTypedSelector(state => state.widget)
  const { getMessages } = useActions()

  useEffect(() => {
    getMessages()
  }, [])

  return (
    <div id={"widget"} className={"widget"}>
      <WidgetButton/>
      {typeChat ? <ChatWindow/> : null}
    </div>
  )
}

export default Chat

const WidgetButton: React.FC = () => {

  const { toggleWidgetIcons } = useActions()
  const { show } = useTypedSelector(state => state.widget)

  const toggleChatIcons = () => {
    toggleWidgetIcons(show)
  }

  const buttonStyle = {
    "display": "none"
  }
  const iconStyle = {
    "display": "block"
  }
  if (show) {
    buttonStyle.display = 'block'
    iconStyle.display = 'none'
  }

  return (
    <div className="widget-button">
      <div className="widget-reverse-btn" onClick={toggleChatIcons}>
        <div className="widget-reverse-btn-wrapper">
          <svg className="chat" style={iconStyle} width="30" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">
            <path fill="#FFFFFF" d="M9.87999 1.04001C4.71899 1.04001 0.519989 4.77257 0.519989 9.36001C0.519989 11.5523 1.4628 13.6012 3.18296 15.1643C2.67076 16.7337 0.82462 17.762 0.80538 17.7734C0.66706 17.8494 0.570908 17.9841 0.543348 18.1391C0.515788 18.2945 0.559712 18.4532 0.663192 18.5717C0.760952 18.6835 1.32137 19.24 2.77061 19.24C6.01541 19.24 7.60799 17.9668 8.06507 17.5165C8.67763 17.6252 9.28667 17.68 9.87999 17.68C15.041 17.68 19.24 13.9474 19.24 9.36001C19.24 4.77257 15.041 1.04001 9.87999 1.04001ZM5.71999 7.28001H14.04C14.3275 7.28001 14.56 7.51245 14.56 7.80001C14.56 8.08757 14.3275 8.32001 14.04 8.32001H5.71999C5.43243 8.32001 5.19999 8.08757 5.19999 7.80001C5.19999 7.51245 5.43243 7.28001 5.71999 7.28001ZM20.0809 7.5522C20.2088 8.13772 20.28 8.74173 20.28 9.36001C20.28 14.521 15.6145 18.72 9.87999 18.72C9.38495 18.72 8.88084 18.6861 8.3728 18.6174C8.22824 18.7292 8.04934 18.8502 7.85382 18.9729C9.42786 21.6036 12.5408 23.4 16.12 23.4C16.7133 23.4 17.3228 23.3452 17.9359 23.2365C18.4455 23.7295 20.0381 24.96 23.2294 24.96C24.6791 24.96 25.2385 24.4045 25.3358 24.2927C25.4398 24.1742 25.4832 24.0146 25.4556 23.8591C25.4286 23.7041 25.3329 23.5699 25.1946 23.4945C25.1748 23.4835 23.3194 22.4479 22.816 20.8853C24.5367 19.3217 25.48 17.2728 25.48 15.08C25.48 11.752 23.2649 8.88184 20.0809 7.5522ZM5.71999 10.4H10.4C10.6875 10.4 10.92 10.6324 10.92 10.92C10.92 11.2076 10.6875 11.44 10.4 11.44H5.71999C5.43243 11.44 5.19999 11.2076 5.19999 10.92C5.19999 10.6324 5.43243 10.4 5.71999 10.4ZM12.48 10.4H14.04C14.3275 10.4 14.56 10.6324 14.56 10.92C14.56 11.2076 14.3275 11.44 14.04 11.44H12.48C12.1924 11.44 11.96 11.2076 11.96 10.92C11.96 10.6324 12.1924 10.4 12.48 10.4Z"></path>
          </svg>
          <svg className="cross" style={buttonStyle} width="55" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 53.758 53.758" enableBackground="new 0 0 53.758 53.758">
            <path fill="#FFFFFF" d="M29.35,26.781l7.582-7.583c0.698-0.697,0.698-1.829,0-2.527c-0.697-0.698-1.829-0.698-2.526,0l-7.582,7.583l-7.583-7.583c-0.699-0.698-1.829-0.698-2.528,0c-0.698,0.698-0.698,1.83,0,2.527l7.582,7.583l-7.582,7.582c-0.698,0.698-0.698,1.83,0,2.527c0.699,0.698,1.829,0.698,2.528,0l7.583-7.582l7.582,7.582c0.697,0.698,1.829,0.698,2.526,0c0.698-0.697,0.698-1.829,0-2.527L29.35,26.781z"></path>
          </svg>
        </div>
      </div>
      <div className="social-buttons">
        <ChatsIcons buttonStyle={buttonStyle} />
      </div>
    </div>
  )
}

const ChatsIcons: React.FC<ChatsIconsProps> = ({ buttonStyle }) => {

  const { showChat } = useActions()

  const showChatWindow = (typeChat: string) => {
    showChat(typeChat)
  }

  return (
    <div className="social-wrapper tg" style={buttonStyle}>
      <div className="social-text text-tg" onClick={()=>{showChatWindow('tg')}}>Telegram</div>
      <div className="social-button icon-tg" style={buttonStyle} onClick={()=>{showChatWindow('tg')}}>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="26px" height="26px">
          <g id="surface16375035">
            <path fill="#FFFFFF" d="M 41.925781 6.640625 C 41.382812 6.664062 40.878906 6.824219 40.433594 7.003906 C 40.015625 7.167969 38.425781 7.851562 35.921875 8.925781 C 33.414062 10 30.09375 11.425781 26.554688 12.949219 C 19.46875 15.996094 11.507812 19.421875 7.429688 21.179688 C 7.273438 21.246094 6.738281 21.414062 6.171875 21.859375 C 5.605469 22.300781 5 23.222656 5 24.246094 C 5 25.070312 5.394531 25.890625 5.886719 26.378906 C 6.382812 26.871094 6.90625 27.113281 7.355469 27.292969 C 8.984375 27.960938 14.035156 30.027344 14.988281 30.417969 C 15.324219 31.445312 17.152344 37.039062 17.578125 38.40625 C 17.859375 39.3125 18.125 39.878906 18.46875 40.328125 C 18.644531 40.554688 18.84375 40.75 19.089844 40.90625 C 19.1875 40.964844 19.292969 41.015625 19.402344 41.058594 L 19.40625 41.0625 C 19.433594 41.070312 19.453125 41.089844 19.480469 41.097656 C 19.527344 41.113281 19.558594 41.117188 19.621094 41.128906 C 19.875 41.210938 20.132812 41.261719 20.359375 41.261719 C 21.335938 41.261719 21.933594 40.726562 21.933594 40.726562 L 21.96875 40.699219 L 26.984375 36.359375 L 33.070312 42.117188 C 33.15625 42.238281 33.953125 43.332031 35.714844 43.332031 C 36.761719 43.332031 37.59375 42.808594 38.125 42.25 C 38.65625 41.691406 38.988281 41.101562 39.132812 40.363281 L 39.132812 40.359375 C 39.261719 39.664062 44.871094 10.878906 44.871094 10.878906 L 44.859375 10.917969 C 45.023438 10.167969 45.066406 9.472656 44.886719 8.78125 C 44.703125 8.09375 44.226562 7.433594 43.636719 7.078125 C 43.042969 6.726562 42.464844 6.617188 41.921875 6.640625 Z M 41.613281 10.125 C 41.601562 10.171875 41.617188 10.148438 41.605469 10.207031 L 41.597656 10.246094 C 41.597656 10.246094 36.0625 38.660156 35.855469 39.742188 C 35.871094 39.660156 35.800781 39.824219 35.734375 39.921875 C 35.632812 39.851562 35.429688 39.765625 35.429688 39.765625 L 35.398438 39.730469 L 27.085938 31.867188 L 21.210938 36.945312 L 22.960938 29.949219 C 22.960938 29.949219 33.886719 18.636719 34.542969 17.980469 C 35.074219 17.453125 35.1875 17.269531 35.1875 17.085938 C 35.1875 16.84375 35.058594 16.667969 34.777344 16.667969 C 34.519531 16.667969 34.175781 16.914062 33.996094 17.03125 C 31.605469 18.554688 21.121094 24.664062 16.417969 27.398438 C 15.671875 27.09375 10.484375 24.96875 8.722656 24.25 C 8.738281 24.246094 8.734375 24.246094 8.746094 24.242188 C 12.828125 22.484375 20.785156 19.058594 27.867188 16.011719 C 31.410156 14.488281 34.730469 13.0625 37.238281 11.988281 C 39.703125 10.929688 41.417969 10.203125 41.613281 10.125 Z M 41.613281 10.125 "></path>
          </g>
        </svg>
      </div>
    </div>
  )
}